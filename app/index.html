<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Practicing Musician</title>

    <link rel="stylesheet" type="text/css" href="pm-listener/sass/notation.scss">

    <script src="pm-listener/js/local_copies/jquery.js"></script>
    <!--<script src="pm-listener/js/local_copies/vexflow.js"></script>-->
    <script src="https://unpkg.com/vexflow@1.2.84/releases/vexflow-debug.js"></script>

    <script type="text/javascript" src="pm-listener/js/logger.js"></script>

    <script type="text/javascript" src="../out/production/PracticingMusician/lib/kotlin.js"></script>
    <script type="text/javascript" src="../out/production/PracticingMusician/PracticingMusician.js"></script>

    <script src="pm-listener/js/aubio.js"></script>
    <script src="pm-listener/js/audio.js"></script>

    <script src="pm-listener/js/easyscore_util.js"></script>

    <script src="pm-listener/js/index.js"></script>

    <script src="pm-listener/js/jsMusicXMLConverter.js"></script>



    <style>
      /* override CSS for the SASS code */
div.feedbackItem.incorrect_note {
    background-image: url("pm-listener/images/miss-icon.svg");
}

div.feedbackItem.off_note {
    background-image: url("pm-listener/images/hit-icon.svg");
}

div#notationPmLogo {
  background-image: url("pm-listener/images/logo.png")
}

#playPauseButton.stopped {
    background-image: url("pm-listener/images/play-arrow-icon.svg");
}

#playPauseButton.restart {
    background-image: url("pm-listener/images/restart-icon.svg");
}

#playPauseButton.playing {
    background-image: url("pm-listener/images/stop-icon.svg");
}

#printButton {
    background-image: url("pm-listener/images/print-icon.svg");
}

span.paginationLink.pageForward {
    background-image: url("pm-listener/images/page-forward-icon.svg");
}

span.paginationLink.pageBackward {
    background-image: url("pm-listener/images/page-back-icon.svg");
}

#metronomeAudioButton {
    background-image: url("pm-listener/images/volume-off-icon.svg");
}

#metronomeAudioButton.checked {
    background-image: url("pm-listener/images/volume-on-icon.svg");
}

#medalIndicator.medal-gold-icon {
    background-image: url("pm-listener/images/medal-gold-icon.svg");
}

#medalIndicator.medal-silver-icon {
    background-image: url("pm-listener/images/medal-silver-icon.svg");
}

#medalIndicator.medal-bronze-icon {
    background-image: url("pm-listener/images/medal-bronze-icon.svg");
}

    </style>

</head>
<body>

<a href="javascript:listenerApp.toggleState()">Start</a>


<div id="notationWindow">
    <div id="notationHeader">

      	<img id="medalIndicator" />
        <span id="tuner">Tuner</span>
        <img src="pm-listener/images/blank.svg" id="playPauseButton" class="stopped" onclick="listenerApp.toggleState()" title="Play/Stop/Repeat"/>
        <img src="pm-listener/images/blank.svg" id="metronomeAudioButton" title="Metronome Audio On/Off"/>


        <div id="controlsContainer">


	        <div id="listenerControls">
            <div id="metronomeAndSlider">
              <div id="metronomeContainer">
              </div>
              <div id="sliderContainer">
                <input class="slider" id="metronomeSlider" type="range" min="0" max="100" value="0" />
                <div id="sliderNumbers">
                </div>
              </div>
            </div>

	          <input id="tempoMarking" type="text"></input>
            <span id="tempoMarkingMeta">BPM</span>
          </div>
        </div>

        <img src="pm-listener/images/blank.svg" id="printButton" title="Print"/>

    </div>

    <div id="notationBody">
        <!-- this gets filled dynamically -->
    </div>
</div>
<script type="text/javascript">
    window.onload = function() {
        listenerApp.runApp({
            url: "",
            xmlUrl: "pm-listener/xml/Finals/5 - Pitch 101/Clarinet - 1 - Agnar Slows To A Stop.xml",
            audioAssetPath: "pm-listener/audio/",

            metronomeSound: false,

            controlsContainerName : "listenerControls",
            notationContainerName : "notationBody",
            metronomeContainerName : "metronomeContainer",

            userID: 1234,
            exerciseID: 1235,

            databaseEndpoint: "db",

            allowableCentsMargin : 40,
            allowableRhythmMargin : 0.40,
            allowableDurationRatio : 0.40,

            largestBeatDifference: 1.0,
            largestDurationRatioDifference: 0.2,
            minDurationInBeats: 0.1,

            displaySiteDialog: function(params) {
              console.log(params)
              alert(
                "Image: " + params.imageType + "\n" +
                "Title: " + params.title + "\n" +
                 "Message: " + params.message
              );
            },
        })
    }
</script>

<style>
  /* the note meter */
div#tuner_note_label {
	text-align: center;
	margin-top: 10px;
}

.note-meter {
  padding: 70px 0 50px 0;
  position: relative;
  //background-color: #f00;
}
.note-meter .needle {
  position: absolute;
  top: 0;
  left: 50%; /* formula: 50 - (50 - 4.5) * (-20 / -50) OR 50 + (50 - 4.5) × (20/50) */
  width: 2px;
  height: 185px;
  /*background: #e75863;*/
  background: #496A8B;
  z-index: 5;
}
.note-meter .needle:after {
  position: absolute;
  top: -4px;
  left: -10px;
  content: '';
  width: 0;
  height: 0;
  border-left: 11px solid transparent;
  border-right: 11px solid transparent;
  border-top: 22px solid #496A8B
}
.note-meter ul {
  list-style-type: none;
  height: 150px;
  margin: 0 auto;
  padding: 0 0 0 0px;
}
.note-meter ul li {
  height: 150px;
  width: 9.0909090909%;
  float: left;
  text-align: center;
  position: relative;
  height: 150px;
  font-size: 13px;
  color: #dadada;
}
.note-meter ul li:before {
  position: absolute;
  content: '';
  width: 100%;
  left: 0;
  top: 0;
  background: #fff;
  z-index: 3;
}
.note-meter ul li:after {
  position: absolute;
  content: '';
  width: 2px;
  left: 50%;
  top: 0;
  background: #ebebeb;
  height: 100%;
  margin-left: -1px;
  display: block;
  z-index: 1;
}
.note-meter ul li:first-child:before, .note-meter ul li:last-child:before {
  height: 100px;
}
.note-meter ul li:nth-child(2):before, .note-meter ul li:nth-child(11):before {
  height: 80px;
}
.note-meter ul li:nth-child(3):before, .note-meter ul li:nth-child(10):before {
  height: 60px;
}
.note-meter ul li:nth-child(4):before, .note-meter ul li:nth-child(9):before {
  height: 40px;
}
.note-meter ul li:nth-child(5):before, .note-meter ul li:nth-child(8):before {
  height: 20px;
}
.note-meter ul li:nth-child(6):before, .note-meter ul li:nth-child(7):before {
  height: 10px;
}

.note-meter ul li p {
  margin: 0;
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  background: #fff;
  padding: 20px 0 0 0;
  z-index: 2;
}
.note-meter .flat {
    bottom: 10%;
    position: absolute;
    left: 0%;
    color: #dadada;
    font-weight: bold;
    font-size: 24px;
	z-index: 20;
}
.note-meter .sharp {
	bottom: 10%;
    position: absolute;
    right: 0%;
    color: #dadada;
    font-weight: bold;
    font-size: 20px;
	z-index: 20;
}
</style>
<script>
		function placeTuner(centsDifferent) {
			document.getElementById('tunerNeedle').style.left = "" + (centsDifferent > 0 ?
				(50 - (50 - 4.5) * (centsDifferent / -50))
					:
			 	(50 + (50 - 4.5) * (centsDifferent / 50))) + "%"
		}
</script>
<div class="note-meter">
  <div id="tunerNeedle" class="needle"></div>

  <p class='flat'>♭</p>
  <ul>

    <li><p>-50</p></li>
    <li><p>-40</p></li>
    <li><p>-30</p></li>
    <li><p>-20</p></li>
    <li><p>-10</p></li>
    <li><p>0</p></li>
    <li><p>10</p></li>
    <li><p>20</p></li>
    <li><p>30</p></li>
    <li><p>40</p></li>
    <li><p>50</p></li>

  </ul>
  <p class="sharp">#</p>
  <div id="tuner_note_label">G#</div>
</div>

</body>
</html>
