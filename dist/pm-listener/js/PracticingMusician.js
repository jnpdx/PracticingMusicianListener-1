if("undefined"==typeof kotlin)throw new Error("Error loading module 'PracticingMusician'. Its dependency 'kotlin' was not found. Please, check whether 'kotlin' is loaded prior to 'PracticingMusician'.");var PracticingMusician=function(t,e){"use strict";function n(){this.scoreUtil=this.scoreUtil,this.generatedExercise=this.generatedExercise,this.parameters=this.parameters,this.audioManager=this.audioManager,this.exerciseManager=this.exerciseManager,this.currentFeedbackItems=e.kotlin.collections.ArrayList_init_ww73n8$()}function o(t){return!0}function i(t,e){this.type=t,this.message=e}function r(t,e,n){this.testPitch=t,this.testRhythm=e,this.testDuration=n}function a(){}function s(){}function l(){}function c(){}function p(t,e){this.noteNumber=t,this.duration=e}function u(t,e){this.x=t,this.y=e}function h(){Dt=this,this.metronomeAudioOn_fgazsk$_0=!0,this.transposition=0,this.tempo=-1,this.pitch=440}function m(){return null===Dt&&new h,Dt}function d(){this.loadedAudio=e.kotlin.collections.LinkedHashMap_init_q3lmfv$(),this.timeoutKeys=e.kotlin.collections.ArrayList_init_ww73n8$()}function f(t,n){return function(){return pm_log("(( Playing..."+e.toString(t),6),null!=n&&(n.currentTime=0),null!=n?n.play():null}}function g(t){return!0}function y(){this.notes=e.kotlin.collections.ArrayList_init_ww73n8$(),this.notationItems=e.kotlin.collections.ArrayList_init_ww73n8$(),this.tempo=120,this.prerollLengthInBeats=4}function _(t){this.currentExercise=null,this.timeKeeper=new nt,this.metronome=new Q,this.pitchTracker=new et,this.bufferManager=new L,this.comparisonEngine=new z,this.audioManager=t,pm_log("Init"),this.lastAnalysisTimestamp=St.MIN_VALUE}function v(t){return function(n){var o;t.audioManager.cancelAllAudio(),t.metronome.cancelAllUIUpdates();var i=t.pitchTracker.samples.size/44100;pm_log("Total samples recorded: "+e.toString(t.pitchTracker.samples.size)+" length: "+e.toString(i)),t.bufferManager.tempo=t.metronome.tempo;var r=t.bufferManager.convertSamplesBufferToNotes_mtnj1d$(t.pitchTracker.samples);pm_log("Notes: ");var a;for(a=r.iterator();a.hasNext();){var s=a.next();pm_log("Note: "+e.toString(s.note.noteNumber)+" for "+e.toString(s.note.duration)+" at "+e.toString(s.positionInBeats))}if(null!=(o=t.currentExercise)){var l=t;pm_log("Comparing...");var c=l.comparisonEngine.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,o.notes,r);listenerApp.clearFeedbackItems();var p;for(p=c.feedbackItems.iterator();p.hasNext();){var u=p.next();listenerApp.addFeedbackItem_775p9r$(u)}window.alert("Overall accuracy: "+e.toString(c.correct)+"/"+e.toString(c.attempted)),U().buildAndSendRequest_fhpv3e$(c)}}}function $(){Mt=this,this.sampleRate=44100,this.minDurationInBeats=.25}function b(){return null===Mt&&new $,Mt}function w(){Rt=this,this.allowableFreqencyMargin=10,this.allowableRhythmMargin=.25}function S(){return null===Rt&&new w,Rt}function x(t,e){this.name=t,this.value=e}function k(t,e){It.call(this),this.name$=t,this.ordinal$=e}function N(){N=function(){},Kt=new k("Correct",0),Ut=new k("Incorrect",1),Wt=new k("Missed",2)}function A(){return N(),Kt}function C(){return N(),Ut}function T(){return N(),Wt}function I(t,e,n){this.type=t,this.beat=e,this.feedbackItemType=n}function P(t){t.type!==T()&&(t.type=C())}function O(t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.c=t,this.a=n,this.correct=this.c,this.attempted=this.a,this.feedbackItems=e.kotlin.collections.ArrayList_init_ww73n8$(),this.finalResults=e.kotlin.collections.ArrayList_init_ww73n8$()}function j(t,e,n,o,i,r,a,s){void 0===t&&(t=-1),void 0===e&&(e=-1),this.userID=t,this.exerciseID=e,this.correct=n,this.attempted=o,this.exerciseAveragePitch=i,this.exerciseAverageRhythm=r,this.exerciseAverageDuration=a,this.notePerformances=s}function E(t,e,n,o,i,r){this.idealBeat=t,this.actualBeat=e,this.idealPitch=n,this.actualPitch=o,this.idealDuration=i,this.actualDuration=r}function F(t,e){this.note=t,this.positionInBeats=e}function L(){this.tempo=0,this.sampleRate=44100,this.minDurationInBeats=.24}function z(){this.largestDurationRatioDifference=.5,this.largestBeatDifference=1}function q(t){this.frequency=t,this.markers=null}function B(t,e){It.call(this),this.name$=t,this.ordinal$=e}function D(){D=function(){},Jt=new B("NoteChange",0),Ht=new B("BeatChange",1)}function M(){return D(),Jt}function R(){return D(),Ht}function K(){Vt=this,this.mapTest=Lt([Ft("test",1),Ft("test2",4)])}function U(){return null===Vt&&new K,Vt}function W(t){this.performance=t}function J(){this.scorePositionInitialX=60,this.scorePositionInitialY=20,this.scorePositionX=0,this.scorePositionY=0,this.positionInLine=0,this.scorePositionCurrentLine=0,this.measureCounter=0,this.exercise=null,this.generatedExercise=this.generatedExercise,this.vf=null,this.registry=null,this.score=null,this.voice=null,this.beam=null,this.contentScaleFactor=1,this.useScaling=!0,this.assumedCanvasWidth=1024,this.barWidth=200,this.barHeight=160,this.firstBarAddition=40,this.barsPerLine=4,this.noteIDNumber=0,this.systems=e.kotlin.collections.ArrayList_init_ww73n8$()}function H(){}function V(){}function G(t,e,n){Y(),void 0===n&&(n="none"),this.noteNumber=t,this.duration=e,this.textValue=n,this.avgFreq=null}function X(){Gt=this}function Y(){return null===Gt&&new X,Gt}function Q(){this.downbeatAudioKey="downbeatSound",this.beatAudioKey="beatSound",this.audioManager=this.audioManager,this.state_t08vao$_0=rt(),this.timeSignature=4,this.prerollBeats=4,this.tempo=120,this.currentBeat=0,this.beatTimes=e.kotlin.collections.ArrayList_init_ww73n8$(),this.lastBeatOccuredAt=-1,this.timeoutKeys=e.kotlin.collections.ArrayList_init_ww73n8$()}function Z(t){return!0}function tt(t,e,n){this.freq=t,this.lengthInSamples=e,this.timestampInSamples=n}function et(){this.sampleRate=44100,this.lengthOfPrerollToIgnore=0,this.latencyTime=180,this.samples=e.kotlin.collections.ArrayList_init_ww73n8$(),this.samplesRecorded=0,this.state_j0gsl6$_0=rt()}function nt(){this.finishedActions=e.kotlin.collections.ArrayList_init_ww73n8$(),this.state_k2u27h$_0=rt(),this.steppables=e.kotlin.collections.ArrayList_init_ww73n8$(),this.analyzers=e.kotlin.collections.ArrayList_init_ww73n8$(),this.timeOffSet=-1,this.runForTime=4100}function ot(t,e){It.call(this),this.name$=t,this.ordinal$=e}function it(){it=function(){},Qt=new ot("Stopped",0),Zt=new ot("Running",1),te=new ot("Completed",2)}function rt(){return it(),Qt}function at(){return it(),Zt}function st(){return it(),te}function lt(t){return function(e){t.step_14dthe$(e)}}function ct(){}function pt(){}function ut(){ee=this}function ht(){this.tracker=new et}function mt(){this.notationContainerName_7mvjxd$_0="notationBody",this.metronomeContainerName_7mvjxd$_0="metronomeContainer",this.userID_7mvjxd$_0=1,this.exerciseID_7mvjxd$_0=2,this.databaseEndpoint_7mvjxd$_0="",this.url_7mvjxd$_0="",this.audioAssetPath_7mvjxd$_0="",this.allowableCentsMargin_7mvjxd$_0=40,this.allowableRhythmMargin_7mvjxd$_0=.25,this.allowableDurationRatio_7mvjxd$_0=.5,this.comparisonFlags_7mvjxd$_0=new r(!0,!0,!0)}function dt(){ne=this,this.notes=Bt([new G(69,.5),new G(81,1),new G(69,1),new G(81,1)]),this.tempo=120,this.secondsPerBeat=60/this.tempo,this.sampleRate=44100,this.bufferLengthInSamples=1024}function ft(){oe=this}function gt(){return null===oe&&new ft,oe}function yt(t){}var _t=e.kotlin.collections.toList_7wnvza$,vt=e.kotlin.ranges.until_dqglrj$,$t=e.kotlin.collections.removeAll_qafx1e$,bt=e.kotlin.collections.toList_us0mfu$,wt=e.kotlin.collections.reversed_7wnvza$,St=e.kotlin.js.internal.DoubleCompanionObject,xt=e.kotlin.collections.toMutableList_4c7yge$,kt=e.kotlin.collections.zip_45mdf7$,Nt=e.kotlin.io.println_s8jyv4$,At=e.kotlin.collections.withIndex_7wnvza$,Ct=e.kotlin.collections.get_indices_gzk92b$,Tt=e.kotlin.collections.plus_qloxvw$,It=e.kotlin.Enum,Pt=e.kotlin.collections.average_l63kqw$,Ot=e.kotlin.js.internal.IntCompanionObject,jt=e.kotlin.Pair,Et=e.kotlin.collections.last_2p1efm$,Ft=e.kotlin.to_ujzrz7$,Lt=e.kotlin.collections.mapOf_qfcya0$,zt=e.kotlin.ranges.IntRange,qt=e.kotlin.ranges.step_xsgg7u$,Bt=e.kotlin.collections.listOf_i5x0yv$;k.prototype=Object.create(It.prototype),k.prototype.constructor=k,B.prototype=Object.create(It.prototype),B.prototype.constructor=B,ot.prototype=Object.create(It.prototype),ot.prototype.constructor=ot,n.prototype.runApp=function(t){this.audioManager=new d,this.exerciseManager=new _(this.audioManager),this.scoreUtil=new EasyScoreUtil,this.parameters=t,Y().createAllNotes(),audioAnalyzer.setupMedia(),this.generatedExercise=generateExerciseForKotlin(),this.generatedExercise=m().applyToExercise_k94nyn$(this.generatedExercise),this.exerciseManager.loadExercise(),this.makeDomElements()},n.prototype.makeDomElements=function(){var t,n,o,i,r,a;pm_log("Making window w/ container: "+this.parameters.notationContainerName,10);var s=e.isType(t=document.getElementById(this.parameters.notationContainerName),HTMLElement)?t:e.throwCCE();s.className=s.className+"notationBodyContainer";var l=e.isType(n=document.createElement("canvas"),HTMLElement)?n:e.throwCCE();l.style.position="absolute",l.id="indicatorCanvas",null!=(o=document.getElementById(this.parameters.notationContainerName))&&o.appendChild(l),pm_log("Made indicator canvas on notation body: ",10),pm_log(e.isType(i=document.getElementById(this.parameters.notationContainerName),HTMLElement)?i:e.throwCCE());var c=e.isType(r=document.createElement("canvas"),HTMLElement)?r:e.throwCCE();c.style.position="absolute",c.id="feedbackCanvas",null!=(a=document.getElementById(this.parameters.notationContainerName))&&a.appendChild(c),this.makeScore_61zpoe$(this.parameters.notationContainerName)},n.prototype.makeScore_61zpoe$=function(t){this.scoreUtil=new EasyScoreUtil,this.scoreUtil.containerElementName=this.parameters.notationContainerName;var e=generateExerciseEasyScoreCode();this.scoreUtil.exercise=e,this.scoreUtil.generatedExercise=this.generatedExercise,pm_log("Setting up score on "+t),this.scoreUtil.setupOnElement(t),this.scoreUtil.setupMetronome(this.parameters.metronomeContainerName),this.scoreUtil.buildTitleElements(t),this.scoreUtil.notateExercise()},n.prototype.toggleState=function(){var t;if(t=this.exerciseManager.timeKeeper.state,e.equals(t,rt())){if(!audioAnalyzer.isFunctional||!audioAnalyzer.hasMicrophoneAccess)return void displayFlashMessages([new i("danger","Audio not working.  Please make sure you are using either Chrome or Firefox and have enabled microphone access.")]);this.exerciseManager.createSteppables(),this.exerciseManager.setup(),this.exerciseManager.loadExercise(),this.exerciseManager.run()}else e.equals(t,at())?this.exerciseManager.stop():e.equals(t,st())},n.prototype.doResizeActions=function(){var t,n;pm_log("Resized window w/ container: "+this.parameters.notationContainerName,10);var o=e.isType(t=document.getElementsByTagName("svg")[0],Element)?t:e.throwCCE();null!=(n=o.parentNode)&&n.removeChild(o),listenerApp.makeScore_61zpoe$(this.parameters.notationContainerName);var i=_t(listenerApp.currentFeedbackItems);listenerApp.clearFeedbackItems();var r;for(r=i.iterator();r.hasNext();){var a=r.next();listenerApp.addFeedbackItem_775p9r$(a)}},n.prototype.moveToPosition_14dthe$=function(t){var n,o=e.isType(n=document.getElementById("indicatorCanvas"),HTMLCanvasElement)?n:null;(null!=o?o.getContext("2d"):null).clearRect(0,0,null!=o?o.width:null,null!=o?o.height:null),this.scoreUtil.drawIndicatorLine(o,t)},n.prototype.highlightMetronomeItem_za3lpa$=function(t){var n,o,i,r,a,s=document.getElementsByClassName("metronomeItem");o=(n=vt(0,s.length)).first,i=n.last,r=n.step;for(var l=o;l<=i;l+=r){var c=e.isType(a=s[l],HTMLElement)?a:e.throwCCE();c.className="metronomeItem",t===l&&(c.className=c.className+" highlighted")}},n.prototype.clearFeedbackItems=function(){var t;$t(this.currentFeedbackItems,o),pm_log("Clearing");for(var n=document.getElementsByClassName("feedbackItem");n.length>0;){var i,r=e.isType(t=n[0],HTMLElement)?t:e.throwCCE();null!=(i=r.parentNode)&&i.removeChild(r)}},n.prototype.addFeedbackItem_775p9r$=function(t){-1===this.currentFeedbackItems.indexOf_11rb$(t)&&this.currentFeedbackItems.add_11rb$(t);var n=this.scoreUtil.getPositionForBeat(t.beat),o=this.scoreUtil.getFeedbackYPosition(n.y),i=this.scoreUtil,r=t.type,a=t.feedbackItemType;i.createFeedbackHTMLElement(r,e.kotlin.collections.copyToArray(a),n.x,o)},n.$metadata$={kind:e.Kind.CLASS,simpleName:"ListenerApp",interfaces:[]},i.$metadata$={kind:e.Kind.CLASS,simpleName:"FlashMessage",interfaces:[]},i.prototype.component1=function(){return this.type},i.prototype.component2=function(){return this.message},i.prototype.copy_puj7f4$=function(t,e){return new i(void 0===t?this.type:t,void 0===e?this.message:e)},i.prototype.toString=function(){return"FlashMessage(type="+e.toString(this.type)+", message="+e.toString(this.message)+")"},i.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.type)|0,t=31*t+e.hashCode(this.message)|0},i.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.type,t.type)&&e.equals(this.message,t.message)},r.$metadata$={kind:e.Kind.CLASS,simpleName:"ComparisonFlags",interfaces:[]},r.prototype.component1=function(){return this.testPitch},r.prototype.component2=function(){return this.testRhythm},r.prototype.component3=function(){return this.testDuration},r.prototype.copy_ws0pad$=function(t,e,n){return new r(void 0===t?this.testPitch:t,void 0===e?this.testRhythm:e,void 0===n?this.testDuration:n)},r.prototype.toString=function(){return"ComparisonFlags(testPitch="+e.toString(this.testPitch)+", testRhythm="+e.toString(this.testRhythm)+", testDuration="+e.toString(this.testDuration)+")"},r.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.testPitch)|0,t=31*t+e.hashCode(this.testRhythm)|0,t=31*t+e.hashCode(this.testDuration)|0},r.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.testPitch,t.testPitch)&&e.equals(this.testRhythm,t.testRhythm)&&e.equals(this.testDuration,t.testDuration)},a.$metadata$={kind:e.Kind.INTERFACE,simpleName:"AppSetupParameters",interfaces:[]},s.$metadata$={kind:e.Kind.INTERFACE,simpleName:"AudioAnalyzer",interfaces:[]},l.$metadata$={kind:e.Kind.INTERFACE,simpleName:"GeneratedExercise",interfaces:[]},c.$metadata$={kind:e.Kind.INTERFACE,simpleName:"EasyScoreCode",interfaces:[]},p.$metadata$={kind:e.Kind.CLASS,simpleName:"SimpleJSNoteObject",interfaces:[]},p.prototype.component1=function(){return this.noteNumber},p.prototype.component2=function(){return this.duration},p.prototype.copy_5wr77w$=function(t,e){return new p(void 0===t?this.noteNumber:t,void 0===e?this.duration:e)},p.prototype.toString=function(){return"SimpleJSNoteObject(noteNumber="+e.toString(this.noteNumber)+", duration="+e.toString(this.duration)+")"},p.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.noteNumber)|0,t=31*t+e.hashCode(this.duration)|0},p.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.noteNumber,t.noteNumber)&&e.equals(this.duration,t.duration)},u.$metadata$={kind:e.Kind.CLASS,simpleName:"BeatPosition",interfaces:[]},u.prototype.component1=function(){return this.x},u.prototype.component2=function(){return this.y},u.prototype.copy_lu1900$=function(t,e){return new u(void 0===t?this.x:t,void 0===e?this.y:e)},u.prototype.toString=function(){return"BeatPosition(x="+e.toString(this.x)+", y="+e.toString(this.y)+")"},u.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.x)|0,t=31*t+e.hashCode(this.y)|0},u.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.x,t.x)&&e.equals(this.y,t.y)},Object.defineProperty(h.prototype,"metronomeAudioOn",{get:function(){return this.metronomeAudioOn_fgazsk$_0},set:function(t){pm_log("Metronome audio value changed",10),this.metronomeAudioOn_fgazsk$_0=t}}),h.prototype.applyToExercise_k94nyn$=function(t){var n,o=bt(t.notes),i=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(o,10));for(n=o.iterator();n.hasNext();){var r,a=n.next(),s=i.add_11rb$;t:do{if(0!==m().transposition){r=new p(a.noteNumber+m().transposition|0,a.duration);break t}r=a}while(!1);s.call(i,r)}return t.notes=e.kotlin.collections.copyToArray(i),-1!==this.tempo&&(t.tempo=this.tempo),t},h.$metadata$={kind:e.Kind.OBJECT,simpleName:"UserSettings",interfaces:[]};var Dt=null;d.prototype.loadAudioFile_puj7f4$=function(t,e){var n=new Audio(t);return this.loadedAudio.put_xwzc9p$(e,n),n},d.prototype.playAudioNow_61zpoe$=function(t){pm_log("**** (( Playing...",6);var e=this.loadedAudio.get_11rb$(t);null!=e&&(e.currentTime=0),null!=e&&e.play()},d.prototype.playAudio_bm4lxs$=function(t,e){var n=this.loadedAudio.get_11rb$(t),o=window.setTimeout(f(e,n),e);this.timeoutKeys.add_11rb$(o)},d.prototype.cancelAllAudio=function(){var t;for(t=wt(this.timeoutKeys).iterator();t.hasNext();){var e=t.next();pm_log("Cancelling item... "+e),window.clearTimeout(e)}$t(this.timeoutKeys,g)},d.$metadata$={kind:e.Kind.CLASS,simpleName:"AudioManager",interfaces:[]},y.prototype.getLength=function(){var t,n=6e4/this.tempo,o=this.notes,i=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(o,10));for(t=o.iterator();t.hasNext();){var r=t.next();i.add_11rb$(r.duration)}var a=i.iterator();if(!a.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var s=a.next();a.hasNext();){var l=s;s=a.next()+l}return s*n},y.prototype.prerollLength=function(){return 6e4/this.tempo*this.prerollLengthInBeats},y.$metadata$={kind:e.Kind.CLASS,simpleName:"ExerciseDefinition",interfaces:[]},_.prototype.createSteppables=function(){this.timeKeeper=new nt,this.metronome=new Q,this.pitchTracker=new et,this.bufferManager=new L,this.comparisonEngine=new z,this.lastAnalysisTimestamp=St.MIN_VALUE},_.prototype.setup=function(){pm_log("Setup"),listenerApp.clearFeedbackItems(),this.metronome.audioManager=this.audioManager,this.timeKeeper.steppables.add_11rb$(this.metronome),this.timeKeeper.steppables.add_11rb$(this.pitchTracker),this.timeKeeper.analyzers.add_11rb$(this),this.timeKeeper.finishedActions.add_11rb$(v(this)),this.metronome.setup(),this.pitchTracker.setup()},_.prototype.run=function(){this.metronome.start(),this.pitchTracker.start(),this.timeKeeper.start()},_.prototype.stop=function(){this.timeKeeper.stop(),this.metronome.stop(),this.pitchTracker.stop()},_.prototype.loadExercise=function(){var t;pm_log("Loading exericse:");var n=listenerApp.generatedExercise,o=new y;o.tempo=n.tempo,o.prerollLengthInBeats=n.count_off;var i,r=n.notes,a=e.kotlin.collections.ArrayList_init_ww73n8$(r.length);for(i=0;i!==r.length;++i){var s=r[i];a.add_11rb$(new G(s.noteNumber,s.duration))}o.notes=xt(a),pm_log("Loaded "+e.toString(o.notes.size)+" notes"),pm_log(o.notes),this.currentExercise=o,null!=(t=this.currentExercise)&&(this.metronome.tempo=t.tempo,console.log("Testing time sig:"),console.log(n),this.metronome.timeSignature=n.time_signature,this.metronome.prerollBeats=n.count_off,this.bufferManager.tempo=t.tempo,this.timeKeeper.runForTime=t.getLength()+t.prerollLength()+this.pitchTracker.latencyTime,this.pitchTracker.lengthOfPrerollToIgnore=t.prerollLength(),pm_log("Loaded exercise of length "+e.toString(this.timeKeeper.runForTime)))},_.prototype.analyze_14dthe$=function(t){var n;if(t-this.lastAnalysisTimestamp>200&&(this.lastAnalysisTimestamp=t,null!=(n=this.currentExercise))){pm_log("Samples length: "+e.toString(this.pitchTracker.samples.size));var o=this.bufferManager.convertSamplesBufferToNotes_mtnj1d$(this.pitchTracker.samples),i=this.comparisonEngine.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,n.notes,o,!0);listenerApp.clearFeedbackItems();var r;for(r=i.feedbackItems.iterator();r.hasNext();){var a=r.next();listenerApp.addFeedbackItem_775p9r$(a)}}},_.$metadata$={kind:e.Kind.CLASS,simpleName:"ExerciseManager",interfaces:[pt]},$.prototype.convertSamplesBufferToNotes_av4ikl$=function(t,n){var o,i,r=60/n,a=e.kotlin.collections.ArrayList_init_ww73n8$(),s={v:-1},l=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(t,10));for(i=t.iterator();i.hasNext();){var c=i.next();l.add_11rb$(Y().getNoteNumber_14dthe$(c))}var p,u=kt(t,l),h=e.kotlin.collections.ArrayList_init_ww73n8$(),m={v:e.kotlin.collections.ArrayList_init_ww73n8$()};for(p=u.iterator();p.hasNext();){var d=p.next();d.second===s.v?m.v.add_11rb$(d):m.v.size>0&&(h.add_11rb$(m.v),m.v=e.kotlin.collections.ArrayList_init_ww73n8$()),s.v=d.second}m.v.size>0&&h.add_11rb$(m.v);var f,g=e.kotlin.collections.ArrayList_init_ww73n8$();for(f=h.iterator();f.hasNext();){var y=f.next();y.size>r*this.minDurationInBeats*this.sampleRate&&g.add_11rb$(y)}var _=g;Nt("Converted into number groups: "+e.toString(_.size)+" from original: "+e.toString(h.size));var v,$=e.kotlin.collections.ArrayList_init_ww73n8$();for(v=_.iterator();v.hasNext();){var b=v.next();e.kotlin.collections.addAll_ipc267$($,b)}var w=$;s.v=-1;var S=0,x=0;for(o=w.iterator();o.hasNext();){var k=o.next(),N=k.second,A=k.first;if(N!==s.v){if(S>0){var C=S/(r*this.sampleRate);x/=S;var T=new G(s.v,C);T.avgFreq=x,a.add_11rb$(T)}x=0,S=-1}x+=A,s.v=N,S=S+1|0}if(S>0){var I=S/(r*this.sampleRate);x/=S;var P=new G(s.v,I);P.avgFreq=x,a.add_11rb$(P)}return console.log("Turned samples into these notes: "+e.toString(a)),a},$.prototype.convertNotesToSamples_jisecs$=function(t,n){var o,i=e.kotlin.collections.ArrayList_init_ww73n8$(),r=60/n,a=e.kotlin.collections.ArrayList_init_ww73n8$();for(o=t.iterator();o.hasNext();){var s,l,c,p,u=o.next();a.add_11rb$(i.size);var h=u.duration*r*this.sampleRate,m=u.getFrequency();l=(s=vt(0,0|h)).first,c=s.last,p=s.step;for(var d=l;d<=c;d+=p)i.add_11rb$(m)}return console.log("Note change indexes: "+e.toString(a)),i},$.$metadata$={kind:e.Kind.OBJECT,simpleName:"BufferManager",interfaces:[]};var Mt=null;w.prototype.compareNoteArrays_l4hzig$=function(t,n){var o,i,r,a,s,l=new O,c=0;for(o=At(t).iterator();o.hasNext();){var p=o.next(),u=p.component1(),h=p.component2(),m=-1,d=0,f=0,g=St.MAX_VALUE;r=(i=Ct(n)).first,a=i.last,s=i.step;for(var y=r;y<=a;y+=s){var _=n.get_za3lpa$(y),v=Math.abs(c-f);v<g&&(m=y,d=f,g=v),f+=_.duration}Nt("Going to compare ideal index "+u+" to test index "+m);var $=new I(C(),c,e.kotlin.collections.emptyList_287e2$());if(l.feedbackItems.add_11rb$($),-1!==m){l.attempted=l.attempted+1|0;var b=!0,w=h,S=n.get_za3lpa$(m);Nt("Durations : "+e.toString(w.duration)+" | "+e.toString(S.duration)),w.duration-S.duration>this.allowableRhythmMargin?(Nt("Test subject too short"),b=!1):w.duration-S.duration<-this.allowableRhythmMargin?(Nt("Test subject too long"),b=!1):Nt("PERFECT"),Nt("Starting points : "+e.toString(c)+" | "+e.toString(d)),c-d>this.allowableRhythmMargin?(Nt("Test subject rushing"),$.feedbackItemType=Tt($.feedbackItemType,new x("rhythm","rushing")),b=!1):c-d<-this.allowableRhythmMargin?(Nt("Test subject dragging"),$.feedbackItemType=Tt($.feedbackItemType,new x("rhythm","dragging")),b=!1):Nt("PERFECT"),Nt("Pitch : "+e.toString(w.getFrequency())+" | "+e.toString(S.getFrequency())),Nt("Avg freq of test item: "+e.toString(S.avgFreq));var k=S.avgFreq;null!=k&&(k-w.getFrequency()>this.allowableFreqencyMargin?(Nt("Test subject sharp"),$.feedbackItemType=Tt($.feedbackItemType,new x("pitch","sharp")),b=!1):k-w.getFrequency()<-this.allowableFreqencyMargin?(Nt("Test subject flat"),$.feedbackItemType=Tt($.feedbackItemType,new x("pitch","flat")),b=!1):Nt("PERFECT")),c+=h.duration,b&&(l.correct=l.correct+1|0)}}return Nt("---- Results : "+e.toString(l.correct)+"/"+e.toString(l.attempted)),l},w.$metadata$={kind:e.Kind.OBJECT,simpleName:"CompareEngine",interfaces:[]};var Rt=null;x.$metadata$={kind:e.Kind.CLASS,simpleName:"FeedbackMetric",interfaces:[]},x.prototype.component1=function(){return this.name},x.prototype.component2=function(){return this.value},x.prototype.copy_puj7f4$=function(t,e){return new x(void 0===t?this.name:t,void 0===e?this.value:e)},x.prototype.toString=function(){return"FeedbackMetric(name="+e.toString(this.name)+", value="+e.toString(this.value)+")"},x.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.name)|0,t=31*t+e.hashCode(this.value)|0},x.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.name,t.name)&&e.equals(this.value,t.value)};var Kt,Ut,Wt;k.$metadata$={kind:e.Kind.CLASS,simpleName:"FeedbackType",interfaces:[It]},k.values=function(){return[A(),C(),T()]},k.valueOf_61zpoe$=function(t){switch(t){case"Correct":return A();case"Incorrect":return C();case"Missed":return T();default:e.throwISE("No enum constant com.practicingmusician.finals.FeedbackType."+t)}},I.$metadata$={kind:e.Kind.CLASS,simpleName:"FeedbackItem",interfaces:[]},I.prototype.component1=function(){return this.type},I.prototype.component2=function(){return this.beat},I.prototype.component3=function(){return this.feedbackItemType},I.prototype.copy_4nfbc1$=function(t,e,n){return new I(void 0===t?this.type:t,void 0===e?this.beat:e,void 0===n?this.feedbackItemType:n)},I.prototype.toString=function(){return"FeedbackItem(type="+e.toString(this.type)+", beat="+e.toString(this.beat)+", feedbackItemType="+e.toString(this.feedbackItemType)+")"},I.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.type)|0,t=31*t+e.hashCode(this.beat)|0,t=31*t+e.hashCode(this.feedbackItemType)|0},I.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.type,t.type)&&e.equals(this.beat,t.beat)&&e.equals(this.feedbackItemType,t.feedbackItemType)},O.prototype.generateResultForDatabase=function(){var t,n=this.finalResults,o=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(n,10));for(t=n.iterator();t.hasNext();){var i=t.next();o.add_11rb$(i.idealPitch-i.actualPitch)}var r,a=Pt(o),s=this.finalResults,l=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(s,10));for(r=s.iterator();r.hasNext();){var c=r.next();l.add_11rb$(c.idealBeat-c.actualBeat)}var p,u=Pt(l),h=this.finalResults,m=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(h,10));for(p=h.iterator();p.hasNext();){var d=p.next();m.add_11rb$(d.idealDuration-d.actualDuration)}var f=Pt(m);return new j(void 0,void 0,this.correct,this.attempted,a,u,f,this.finalResults)},O.$metadata$={kind:e.Kind.CLASS,simpleName:"CompareResults",interfaces:[]},j.$metadata$={kind:e.Kind.CLASS,simpleName:"ResultsForDatabase",interfaces:[]},j.prototype.component1=function(){return this.userID},j.prototype.component2=function(){return this.exerciseID},j.prototype.component3=function(){return this.correct},j.prototype.component4=function(){return this.attempted},j.prototype.component5=function(){return this.exerciseAveragePitch},j.prototype.component6=function(){return this.exerciseAverageRhythm},j.prototype.component7=function(){return this.exerciseAverageDuration},j.prototype.component8=function(){return this.notePerformances},j.prototype.copy_ch5twz$=function(t,e,n,o,i,r,a,s){return new j(void 0===t?this.userID:t,void 0===e?this.exerciseID:e,void 0===n?this.correct:n,void 0===o?this.attempted:o,void 0===i?this.exerciseAveragePitch:i,void 0===r?this.exerciseAverageRhythm:r,void 0===a?this.exerciseAverageDuration:a,void 0===s?this.notePerformances:s)},j.prototype.toString=function(){return"ResultsForDatabase(userID="+e.toString(this.userID)+", exerciseID="+e.toString(this.exerciseID)+", correct="+e.toString(this.correct)+", attempted="+e.toString(this.attempted)+", exerciseAveragePitch="+e.toString(this.exerciseAveragePitch)+", exerciseAverageRhythm="+e.toString(this.exerciseAverageRhythm)+", exerciseAverageDuration="+e.toString(this.exerciseAverageDuration)+", notePerformances="+e.toString(this.notePerformances)+")"},j.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.userID)|0,t=31*t+e.hashCode(this.exerciseID)|0,t=31*t+e.hashCode(this.correct)|0,t=31*t+e.hashCode(this.attempted)|0,t=31*t+e.hashCode(this.exerciseAveragePitch)|0,t=31*t+e.hashCode(this.exerciseAverageRhythm)|0,t=31*t+e.hashCode(this.exerciseAverageDuration)|0,t=31*t+e.hashCode(this.notePerformances)|0},j.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.userID,t.userID)&&e.equals(this.exerciseID,t.exerciseID)&&e.equals(this.correct,t.correct)&&e.equals(this.attempted,t.attempted)&&e.equals(this.exerciseAveragePitch,t.exerciseAveragePitch)&&e.equals(this.exerciseAverageRhythm,t.exerciseAverageRhythm)&&e.equals(this.exerciseAverageDuration,t.exerciseAverageDuration)&&e.equals(this.notePerformances,t.notePerformances)},E.$metadata$={kind:e.Kind.CLASS,simpleName:"IndividualNotePerformanceInfo",interfaces:[]},E.prototype.component1=function(){return this.idealBeat},E.prototype.component2=function(){return this.actualBeat},E.prototype.component3=function(){return this.idealPitch},E.prototype.component4=function(){return this.actualPitch},E.prototype.component5=function(){return this.idealDuration},E.prototype.component6=function(){return this.actualDuration},E.prototype.copy_15yvbs$=function(t,e,n,o,i,r){return new E(void 0===t?this.idealBeat:t,void 0===e?this.actualBeat:e,void 0===n?this.idealPitch:n,void 0===o?this.actualPitch:o,void 0===i?this.idealDuration:i,void 0===r?this.actualDuration:r)},E.prototype.toString=function(){return"IndividualNotePerformanceInfo(idealBeat="+e.toString(this.idealBeat)+", actualBeat="+e.toString(this.actualBeat)+", idealPitch="+e.toString(this.idealPitch)+", actualPitch="+e.toString(this.actualPitch)+", idealDuration="+e.toString(this.idealDuration)+", actualDuration="+e.toString(this.actualDuration)+")"},E.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.idealBeat)|0,t=31*t+e.hashCode(this.actualBeat)|0,t=31*t+e.hashCode(this.idealPitch)|0,t=31*t+e.hashCode(this.actualPitch)|0,t=31*t+e.hashCode(this.idealDuration)|0,t=31*t+e.hashCode(this.actualDuration)|0},E.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.idealBeat,t.idealBeat)&&e.equals(this.actualBeat,t.actualBeat)&&e.equals(this.idealPitch,t.idealPitch)&&e.equals(this.actualPitch,t.actualPitch)&&e.equals(this.idealDuration,t.idealDuration)&&e.equals(this.actualDuration,t.actualDuration)},F.$metadata$={kind:e.Kind.CLASS,simpleName:"NotePlacement",interfaces:[]},F.prototype.component1=function(){return this.note},F.prototype.component2=function(){return this.positionInBeats},F.prototype.copy_uilc1j$=function(t,e){return new F(void 0===t?this.note:t,void 0===e?this.positionInBeats:e)},F.prototype.toString=function(){return"NotePlacement(note="+e.toString(this.note)+", positionInBeats="+e.toString(this.positionInBeats)+")"},F.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.note)|0,t=31*t+e.hashCode(this.positionInBeats)|0},F.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.note,t.note)&&e.equals(this.positionInBeats,t.positionInBeats)},L.prototype.convertSamplesBufferToNotes_mtnj1d$=function(t){var n=e.kotlin.collections.ArrayList_init_ww73n8$();if(0===t.size)return e.kotlin.collections.emptyList_287e2$();var o=window.performance.now(),i=60/this.tempo,r=t.subList_vux9f0$(0,t.size);pm_log("Converting how many samples: "+e.toString(r.size));var a,s=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(r,10));for(a=r.iterator();a.hasNext();){var l=a.next();s.add_11rb$(l.lengthInSamples)}var c=s.iterator();if(!c.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var p=c.next();c.hasNext();)p=p+c.next()|0;var u=p/this.sampleRate/i;pm_log("Total length of samples in beats: "+u);var h,m=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(r,10));for(h=r.iterator();h.hasNext();){var d=h.next();m.add_11rb$(Y().getNoteNumber_14dthe$(d.freq))}var f=kt(r,m);pm_log("After mapping and zipping: "+e.toString(window.performance.now()-o));var g,y=e.kotlin.collections.ArrayList_init_ww73n8$(),_={v:e.kotlin.collections.ArrayList_init_ww73n8$()},v={v:Ot.MIN_VALUE};for(g=f.iterator();g.hasNext();){var $=g.next();v.v!==$.second&&(y.add_11rb$(_.v),_.v=e.kotlin.collections.ArrayList_init_ww73n8$()),_.v.add_11rb$($),v.v=$.second}y.add_11rb$(_.v),pm_log("After making pairs: "+e.toString(window.performance.now()-o));var b,w=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(f,10));for(b=f.iterator();b.hasNext();){var S=b.next();w.add_11rb$(S.first.lengthInSamples)}var x=w.iterator();if(!x.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var k=x.next();x.hasNext();)k=k+x.next()|0;var N=k/this.sampleRate/i;pm_log("Total length of collected pairs in beats: "+N);var A,C=e.kotlin.collections.ArrayList_init_ww73n8$();for(A=y.iterator();A.hasNext();){var T=A.next();e.kotlin.collections.addAll_ipc267$(C,T)}var I,P=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(C,10));for(I=C.iterator();I.hasNext();){var O=I.next();P.add_11rb$(O.first.lengthInSamples)}var j=P.iterator();if(!j.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var E=j.next();j.hasNext();)E=E+j.next()|0;var L=E/this.sampleRate/i;pm_log("Total length of groups: "+L);var z,q=e.kotlin.collections.ArrayList_init_ww73n8$();for(z=y.iterator();z.hasNext();){var B=z.next();0!==B.size&&q.add_11rb$(B)}var D,M=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(q,10));for(D=q.iterator();D.hasNext();){var R,K,U=D.next(),W=M.add_11rb$,J=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(U,10));for(K=U.iterator();K.hasNext();){var H=K.next();J.add_11rb$(H.first.lengthInSamples)}var V=J.iterator();if(!V.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var X=V.next();V.hasNext();)X=X+V.next()|0;if(X<i*this.minDurationInBeats*this.sampleRate){var Q,Z=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(U,10));for(Q=U.iterator();Q.hasNext();){var tt=Q.next();Z.add_11rb$(new jt(tt.first,-100))}R=Z}else R=U;W.call(M,R)}var et=M;pm_log("Converted into number groups: "+e.toString(et.size)+" from original: "+e.toString(y.size),0);var nt,ot=e.kotlin.collections.ArrayList_init_ww73n8$();for(nt=et.iterator();nt.hasNext();){var it=nt.next();e.kotlin.collections.addAll_ipc267$(ot,it)}var rt,at=ot,st=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(at,10));for(rt=at.iterator();rt.hasNext();){var lt=rt.next();st.add_11rb$(lt.first.lengthInSamples)}var ct=st.iterator();if(!ct.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var pt=ct.next();ct.hasNext();)pt=pt+ct.next()|0;var ut=pt/this.sampleRate/i;pm_log("Total length of acceptable groups pairs in beats: "+ut),v.v=-1;var ht,mt={v:0},dt={v:0},ft=e.kotlin.collections.ArrayList_init_ww73n8$();for(ht=at.iterator();ht.hasNext();){var gt=ht.next();if(v.v!==gt.second){var yt=new G(v.v,mt.v/(i*this.sampleRate));dt.v=dt.v/mt.v,yt.avgFreq=dt.v,ft.add_11rb$(yt),mt.v=0,dt.v=0}mt.v=mt.v+gt.first.lengthInSamples|0,dt.v+=gt.first.freq*gt.first.lengthInSamples,v.v=gt.second}var _t=new G(v.v,mt.v/(i*this.sampleRate));dt.v=dt.v/mt.v,_t.avgFreq=dt.v,ft.add_11rb$(_t);var vt,$t=e.kotlin.collections.ArrayList_init_ww73n8$();for(vt=ft.iterator();vt.hasNext();){var bt=vt.next();0!==bt.duration&&$t.add_11rb$(bt)}n.addAll_brywnq$($t),pm_log("Notes after combining process: (from original: "+e.toString(at.size),0),pm_log("Turned samples into these notes (before purging): ",0);var wt;for(wt=ft.iterator();wt.hasNext();){var St=wt.next();pm_log("Note: "+e.toString(St.noteNumber)+" for "+e.toString(St.duration),0)}var xt,Nt,At=e.kotlin.collections.ArrayList_init_ww73n8$(),Ct=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(n,10)),Tt=0;for(xt=n.iterator();xt.hasNext();){var It=xt.next(),Pt=Ct.add_11rb$,Et=(Nt=Tt,Tt=Nt+1|0,Nt);t:do{if(-100===It.noteNumber){if(0===Et)break t;var Ft=n.get_za3lpa$(Et-1|0);Ft.duration=Ft.duration+It.duration,At.add_11rb$(It)}}while(!1);Pt.call(Ct,void 0)}pm_log("Removing "+e.toString(At.size),0),n.removeAll_brywnq$(At);var Lt,zt={v:0},qt=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(n,10));for(Lt=n.iterator();Lt.hasNext();){var Bt=Lt.next(),Dt=qt.add_11rb$,Mt=new F(Bt,zt.v);zt.v+=Bt.duration,Dt.call(qt,Mt)}var Rt,Kt=e.kotlin.collections.ArrayList_init_ww73n8$();for(Rt=qt.iterator();Rt.hasNext();){var Ut=Rt.next();-100!==Ut.note.noteNumber&&Kt.add_11rb$(Ut)}var Wt=Kt;pm_log("Turned samples into these notes (after purging): ",0);var Jt;for(Jt=Wt.iterator();Jt.hasNext();){var Ht=Jt.next();pm_log("Note: "+e.toString(Ht.note.noteNumber)+" for "+e.toString(Ht.note.duration)+" at "+e.toString(100*Ht.positionInBeats/100),0)}pm_log("Difference after bogus purge: "+e.toString(ft.size-Wt.size|0),0);var Vt,Gt=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(n,10));for(Vt=n.iterator();Vt.hasNext();){var Xt=Vt.next();Gt.add_11rb$(Xt.duration)}var Yt=Gt.iterator();if(!Yt.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var Qt=Yt.next();Yt.hasNext();)Qt+=Yt.next();var Zt=Qt;pm_log("Length of notes in beats: "+Zt);var te=window.performance.now();return pm_log("Function total time: "+e.toString(te-o)),Wt},L.$metadata$={kind:e.Kind.CLASS,simpleName:"IncrementalBufferManager",interfaces:[]},z.prototype.compareNoteArrays_puujnc$=function(t,n,o,i){void 0===i&&(i=!1);var r,a,s,l,c,p,u,h,m,d,f,g=new O,y=0,_=-1,v=0;o.size>0&&(v=Et(o).positionInBeats,i||(v+=Et(o).note.duration));var $=window.performance.now();a=(r=vt(0,n.size)).first,s=r.last,l=r.step;for(var b=a;b<=s;b+=l){var w,S=n.get_za3lpa$(b),k=-1,N=0,C=St.MAX_VALUE;p=(c=vt(0,o.size)).first,u=c.last,h=c.step;for(var j=p;j<=u;j+=h){w=o.get_za3lpa$(j).positionInBeats;var L=Math.abs(y-w);L<C&&(k=j,N=w,C=L)}if(y>=v)break;k<=_&&pm_log("Already tested here...... "+k+" <= "+_),_=k,pm_log("Going to compare ideal index "+b+" to test index "+k);var z=e.kotlin.collections.ArrayList_init_ww73n8$(),q=new I(A(),y,z);if(g.feedbackItems.add_11rb$(q),-1!==k){g.attempted=g.attempted+1|0;var B=S,D=o.get_za3lpa$(k);if(pm_log("Durations : "+e.toString(B.duration)+" | "+e.toString(D.note.duration),0),t.testDuration){var M=D.note.duration/B.duration,R=Math.round(100*M)/100;z.add_11rb$(new x("dur.",""+e.toString(R))),M<listenerApp.parameters.allowableDurationRatio?(pm_log("Test subject too short by "+e.toString(R),0),z.add_11rb$(new x("duration","-"+e.toString(R))),P(q)):M>1/listenerApp.parameters.allowableDurationRatio?(pm_log("Test subject too long by "+e.toString(R),0),z.add_11rb$(new x("duration","+"+e.toString(Math.abs(R)))),P(q)):pm_log("PERFECT DURATION",0),(M<this.largestDurationRatioDifference||M>1/this.largestDurationRatioDifference)&&(q.type=T())}pm_log("Starting points : "+e.toString(y)+" | "+e.toString(N));var K=-(y-N),U=Math.round(100*K)/100;if(t.testRhythm&&(K>listenerApp.parameters.allowableRhythmMargin?(pm_log("Test subject rushing"),z.add_11rb$(new x("speed","+"+e.toString(U))),P(q)):K<-listenerApp.parameters.allowableRhythmMargin?(pm_log("Test subject dragging"),z.add_11rb$(new x("speed",""+e.toString(U))),P(q)):pm_log("PERFECT"),Math.abs(K)>this.largestBeatDifference&&(q.type=T())),pm_log("Notes : "+e.toString(B.noteNumber)+" | "+e.toString(D.note.noteNumber)),D.note.noteNumber===(B.noteNumber+12|0)||D.note.noteNumber===(B.noteNumber-12|0)){var W=new G(B.noteNumber,D.note.duration);D.note.noteNumber<B.noteNumber?W.avgFreq=null!=(m=D.note.avgFreq)?2*m:null:W.avgFreq=null!=(d=D.note.avgFreq)?d/2:null,D=new F(W,D.positionInBeats)}B.noteNumber!==D.note.noteNumber&&(pm_log("WRONG NOTE *&*&*&*&*&*&*&*"),q.type=T()),pm_log("Pitch : "+e.toString(B.getFrequency())+" | "+e.toString(D.note.getFrequency()),0),pm_log("Avg freq of test item: "+e.toString(D.note.avgFreq));var J=D.note.avgFreq;if(null!=J&&t.testPitch){var H=B.getFrequency(),V=Y().getFrequencyForNoteNumber_za3lpa$(B.noteNumber+1|0),X=Y().getFrequencyForNoteNumber_za3lpa$(B.noteNumber-1|0);if(J-H>0){var Q=V-H,Z=(J-H)/Q*100;pm_log("Sharp by "+Q+" ("+Z+" cents)"),Z>listenerApp.parameters.allowableCentsMargin&&(pm_log("Test subject sharp"),z.add_11rb$(new x("pitch","+"+e.toString(0|Q))),P(q))}else if(J-B.getFrequency()<0){var tt=H-X,et=(H-J)/tt*100;pm_log("Flat by "+tt+" ("+et+" cents)"),et>listenerApp.parameters.allowableCentsMargin&&(pm_log("Test subject flat"),z.add_11rb$(new x("pitch","-"+e.toString(0|tt))),P(q))}else pm_log("PERFECT")}q.type===A()&&(g.correct=g.correct+1|0);var nt=new E(y+=S.duration,N,B.getFrequency(),null!=(f=D.note.avgFreq)?f:-1,B.duration,D.note.duration);g.finalResults.add_11rb$(nt)}else pm_log("No index found to test",10)}var ot=window.performance.now();return pm_log("Function total time: "+e.toString(ot-$)),g},z.$metadata$={kind:e.Kind.CLASS,simpleName:"IncrementalComparisonEngine",interfaces:[]};var Jt,Ht;B.$metadata$={kind:e.Kind.CLASS,simpleName:"MarkerType",interfaces:[It]},B.values=function(){return[M(),R()]},B.valueOf_61zpoe$=function(t){switch(t){case"NoteChange":return M();case"BeatChange":return R();default:e.throwISE("No enum constant com.practicingmusician.models.Slice.MarkerType."+t)}},q.$metadata$={kind:e.Kind.CLASS,simpleName:"Slice",interfaces:[]},K.prototype.makePostRequest_l6nar7$=function(t,e){networkRequest(t,e)},K.prototype.buildAndSendRequest_fhpv3e$=function(t){var e=t.generateResultForDatabase();e.userID=listenerApp.parameters.userID,e.exerciseID=listenerApp.parameters.exerciseID;var n=new W(e);U().makePostRequest_l6nar7$(listenerApp.parameters.databaseEndpoint,n)},K.$metadata$={kind:e.Kind.OBJECT,simpleName:"ListenerNetworkManager",interfaces:[]};var Vt=null;W.$metadata$={kind:e.Kind.CLASS,simpleName:"PerformanceWrapper",interfaces:[]},W.prototype.component1=function(){return this.performance},W.prototype.copy_w32kyh$=function(t){return new W(void 0===t?this.performance:t)},W.prototype.toString=function(){return"PerformanceWrapper(performance="+e.toString(this.performance)+")"},W.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.performance)|0},W.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.performance,t.performance)},J.$metadata$={kind:e.Kind.CLASS,simpleName:"EasyScoreUtil_Kotlin",interfaces:[]},H.$metadata$={kind:e.Kind.INTERFACE,simpleName:"NotationItem",interfaces:[]},V.$metadata$={kind:e.Kind.CLASS,simpleName:"Barline",interfaces:[H]},G.prototype.getFrequency=function(){return Y().getFrequencyForNoteNumber_za3lpa$(this.noteNumber)},X.prototype.getNoteNumber_14dthe$=function(t){return-1===t?-1:this.closestNoteToFrequency_14dthe$(t)},X.prototype.getFrequencyForNoteNumber_za3lpa$=function(t){return m().pitch*Math.pow(2,(t-69)/12)},X.prototype.createAllNotes=function(){var t,n,o,i;Xt=e.kotlin.collections.ArrayList_init_ww73n8$(),n=(t=vt(30,110)).first,o=t.last,i=t.step;for(var r=n;r<=o;r+=i)Xt.add_11rb$(new G(r,1))},X.prototype.closestNoteToFrequency_14dthe$=function(t){var e,n=St.MAX_VALUE,o=-1;for(e=Xt.iterator();e.hasNext();){var i=e.next(),r=Math.abs(i.getFrequency()-t);if(r<n)n=r,o=i.noteNumber;else if(r>n)break}return o},X.$metadata$={kind:e.Kind.OBJECT,simpleName:"Companion",interfaces:[]};var Gt=null;G.$metadata$={kind:e.Kind.CLASS,simpleName:"Note",interfaces:[H]};var Xt;Object.defineProperty(Q.prototype,"state",{get:function(){return this.state_t08vao$_0},set:function(t){this.state_t08vao$_0=t}}),Q.prototype.setup=function(){this.audioManager.loadAudioFile_puj7f4$(listenerApp.parameters.url+listenerApp.parameters.audioAssetPath+"Cowbell.wav",this.downbeatAudioKey),this.audioManager.loadAudioFile_puj7f4$(listenerApp.parameters.url+listenerApp.parameters.audioAssetPath+"Woodblock.wav",this.beatAudioKey)},Q.prototype.start=function(){this.state=at()},Q.prototype.stop=function(){this.state=rt()},Q.prototype.step_zgkg49$=function(t,e){var n=6e4/this.tempo;if(e.runForTime-t<n/2)pm_log("Less than beat size..");else{-1===this.lastBeatOccuredAt&&(this.lastBeatOccuredAt=t-n);var o=this.lastBeatOccuredAt+n,i=t/n;this.updateIndicatorUI_14dthe$(i),t>=o&&(m().metronomeAudioOn&&(this.currentBeat%this.timeSignature==0?this.audioManager.playAudioNow_61zpoe$(this.downbeatAudioKey):this.audioManager.playAudioNow_61zpoe$(this.beatAudioKey)),this.lastBeatOccuredAt=o,this.updateMetronomeUI_za3lpa$(this.currentBeat),this.currentBeat=this.currentBeat+1|0)}},Q.prototype.cancelAllUIUpdates=function(){var t;for(t=wt(this.timeoutKeys).iterator();t.hasNext();){var e=t.next();pm_log("Cancelling item... "+e),window.clearTimeout(e)}$t(this.timeoutKeys,Z)},Q.prototype.updateIndicatorUI_14dthe$=function(t){listenerApp.moveToPosition_14dthe$(t-this.prerollBeats)},Q.prototype.updateMetronomeUI_za3lpa$=function(t){listenerApp.highlightMetronomeItem_za3lpa$(t%this.timeSignature)},Q.prototype.getBeatOfTimestamp_14dthe$=function(t){var e,n,o,i,r,a=-1,s=-1;n=(e=Ct(this.beatTimes)).first,o=e.last,i=e.step;for(var l=n;l<=o;l+=i){var c=this.beatTimes.get_za3lpa$(l);if(c>t){if(-1==(r=l-1|0))return-1;a=this.beatTimes.get_za3lpa$(r),s=c;break}}return-1===a?-1:(t-a)/(s-a)},Q.$metadata$={kind:e.Kind.CLASS,simpleName:"Metronome",interfaces:[ct]};var Yt;tt.$metadata$={kind:e.Kind.CLASS,simpleName:"SampleCollection",interfaces:[]},tt.prototype.component1=function(){return this.freq},tt.prototype.component2=function(){return this.lengthInSamples},tt.prototype.component3=function(){return this.timestampInSamples},tt.prototype.copy_mqu1mq$=function(t,e,n){return new tt(void 0===t?this.freq:t,void 0===e?this.lengthInSamples:e,void 0===n?this.timestampInSamples:n)},tt.prototype.toString=function(){return"SampleCollection(freq="+e.toString(this.freq)+", lengthInSamples="+e.toString(this.lengthInSamples)+", timestampInSamples="+e.toString(this.timestampInSamples)+")"},tt.prototype.hashCode=function(){var t=0;return t=31*t+e.hashCode(this.freq)|0,t=31*t+e.hashCode(this.lengthInSamples)|0,t=31*t+e.hashCode(this.timestampInSamples)|0},tt.prototype.equals=function(t){return this===t||null!==t&&"object"==typeof t&&Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&e.equals(this.freq,t.freq)&&e.equals(this.lengthInSamples,t.lengthInSamples)&&e.equals(this.timestampInSamples,t.timestampInSamples)},et.prototype.setup=function(){},et.prototype.start=function(){this.samplesRecorded=0,this.state=at()},et.prototype.stop=function(){this.state=rt()},Object.defineProperty(et.prototype,"state",{get:function(){return this.state_j0gsl6$_0},set:function(t){this.state_j0gsl6$_0=t}}),et.prototype.step_zgkg49$=function(t,n){var o=audioAnalyzer.updatePitch(t);pm_log("Timestamp: "+e.toString(t)),pm_log("Pitch: "+e.toString(o));var i=Yt/2;this.stepWithFrequency_88ee24$(t,o,i,this.latencyTime)},et.prototype.stepWithFrequency_88ee24$=function(t,n,o,i){var r=t-o/44100*1e3-i-this.lengthOfPrerollToIgnore;pm_log("Timestamp accounting for preroll "+r);var a=o-this.samplesRecorded+44.1*r;a<0?pm_log("Not filling yet..."):(pm_log("Filling "+e.toString(a)+" with "+n),this.samples.add_11rb$(new tt(n,0|a,this.samplesRecorded)),this.samplesRecorded=this.samplesRecorded+(0|a)|0)},et.$metadata$={kind:e.Kind.CLASS,simpleName:"PitchTracker",interfaces:[ct]};var Qt,Zt,te;ot.$metadata$={kind:e.Kind.CLASS,simpleName:"TimeKeeperState",interfaces:[It]},ot.values=function(){return[rt(),at(),st()]},ot.valueOf_61zpoe$=function(t){switch(t){case"Stopped":return rt();case"Running":return at();case"Completed":return st();default:e.throwISE("No enum constant com.practicingmusician.steppable.TimeKeeper.TimeKeeperState."+t)}},Object.defineProperty(nt.prototype,"state",{get:function(){return this.state_k2u27h$_0},set:function(t){if(t===st()){pm_log("Completed",10),this.state_k2u27h$_0=rt();var e;for(e=this.finishedActions.iterator();e.hasNext();)e.next()(!0)}else this.state_k2u27h$_0=t}}),nt.prototype.start=function(){this.state=at(),this.requestNextStep()},nt.prototype.stop=function(){this.state=rt(),this.timeOffSet=-1},nt.prototype.requestNextStep=function(){window.requestAnimationFrame(lt(this))},nt.prototype.step_14dthe$=function(t){-1===this.timeOffSet&&(this.timeOffSet=t);var n=t-this.timeOffSet;pm_log("Calling step at : "+e.toString(n)+" (raw: "+t+")");var o;for(o=this.steppables.iterator();o.hasNext();){var i=o.next();i.state===at()&&i.step_zgkg49$(n,this)}var r;for(r=this.analyzers.iterator();r.hasNext();)r.next().analyze_14dthe$(n);n>=this.runForTime&&(pm_log("STOPPED ((((((((((((((((((((((((((((((())))))))))))))))))",9),this.state=st()),this.state!==rt()&&this.requestNextStep()},nt.prototype.currentTime=function(){return window.performance.now()-this.timeOffSet},nt.$metadata$={kind:e.Kind.CLASS,simpleName:"TimeKeeper",interfaces:[]},ct.$metadata$={kind:e.Kind.INTERFACE,simpleName:"TimeKeeperSteppable",interfaces:[]},pt.$metadata$={kind:e.Kind.INTERFACE,simpleName:"TimeKeeperAnalyzer",interfaces:[]},ut.prototype.runTest=function(){var t,n=new et;for(t=qt(new zt(24,1024),17).iterator();t.hasNext();)t.next();Nt("Samples: "+e.toString(n.samples.size))},ut.prototype.toggleTest=function(){},ut.$metadata$={kind:e.Kind.OBJECT,simpleName:"PitchTrackerTest",interfaces:[]};var ee=null;ht.$metadata$={kind:e.Kind.CLASS,simpleName:"PitchTrackerTestClass",interfaces:[]},Object.defineProperty(mt.prototype,"notationContainerName",{get:function(){return this.notationContainerName_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"metronomeContainerName",{get:function(){return this.metronomeContainerName_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"userID",{get:function(){return this.userID_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"exerciseID",{get:function(){return this.exerciseID_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"databaseEndpoint",{get:function(){return this.databaseEndpoint_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"url",{get:function(){return this.url_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"audioAssetPath",{get:function(){return this.audioAssetPath_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"allowableCentsMargin",{get:function(){return this.allowableCentsMargin_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"allowableRhythmMargin",{get:function(){return this.allowableRhythmMargin_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"allowableDurationRatio",{get:function(){return this.allowableDurationRatio_7mvjxd$_0}}),Object.defineProperty(mt.prototype,"comparisonFlags",{get:function(){return this.comparisonFlags_7mvjxd$_0}}),mt.$metadata$={kind:e.Kind.CLASS,simpleName:"MockParameters",interfaces:[a]},dt.prototype.testShouldBe_3xie8k$=function(t,n){Nt("Results "+e.toString(n.correct)+" / "+e.toString(n.attempted)),t.attempted===n.attempted&&t.correct===n.correct?Nt("---- PASSED -----"):(window.alert("Failed"),Nt("----- ***** FAILED ****** -----"))},dt.prototype.pitchTrackerTest=function(){var t;Nt("***** Pitch tracker test");var n,o=new et,i=gt().generateExactBufferCollectionFromNotes_jisecs$(this.notes,this.tempo);for(o.lengthOfPrerollToIgnore=4*this.secondsPerBeat*1e3,Nt("Sending preroll"),o.stepWithFrequency_88ee24$(o.lengthOfPrerollToIgnore,1,44.1*o.lengthOfPrerollToIgnore,0),n=o.lengthOfPrerollToIgnore,Nt("------"),t=i.iterator();t.hasNext();){var r=t.next();n+=r.lengthInSamples/44100*1e3,Nt("sending "+e.toString(r.lengthInSamples)+" at "+n),o.stepWithFrequency_88ee24$(n,r.freq,r.lengthInSamples,0),Nt("--------")}var a,s=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(i,10));for(a=i.iterator();a.hasNext();){var l=a.next();s.add_11rb$(l.lengthInSamples)}var c=s.iterator();if(!c.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var p=c.next();c.hasNext();)p=p+c.next()|0;var u,h=p,m=o.samples,d=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(m,10));for(u=m.iterator();u.hasNext();){var f=u.next();d.add_11rb$(f.lengthInSamples)}var g=d.iterator();if(!g.hasNext())throw new e.kotlin.UnsupportedOperationException("Empty collection can't be reduced.");for(var y=g.next();g.hasNext();)y=y+g.next()|0;Nt("Sample lengths :  "+h+" | "+y);var _=o.samples,v=new L;v.tempo=this.tempo;var $=v.convertSamplesBufferToNotes_mtnj1d$(_),b=gt().addAvgPitchToSamples_j4do5z$($);Nt("Comparing exact copies (incremental)...");var w=new O;w.correct=4,w.attempted=4;var S=new z;this.testShouldBe_3xie8k$(w,S.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,this.notes,b))},dt.prototype.trueIncrementalBufferAndComparisonTest=function(){},dt.prototype.trueIncrementalBufferTest=function(){var t=new L;t.tempo=this.tempo;var n=gt().generateExactBufferCollectionWithSize1FromNotes_jisecs$(this.notes,this.tempo);console.log("Starting with "+e.toString(n.size));for(var o=e.kotlin.collections.ArrayList_init_ww73n8$(),i=0;;){var r=i+700|0;r>=n.size&&(r=n.size);var a=n.subList_vux9f0$(i,r);o.addAll_brywnq$(a);var s=t.convertSamplesBufferToNotes_mtnj1d$(o);if(i=i+700|0,r===n.size)break;console.log("Notes after slicing:"),console.log(s)}},dt.prototype.trueIncrementalComparisonTest=function(){var t;Nt("****** Beginning true incremental test");var n=new L;n.tempo=this.tempo;var o=gt().generateExactBufferCollectionFromNotes_jisecs$(this.notes,this.tempo),i=n.convertSamplesBufferToNotes_mtnj1d$(o),r=gt().addAvgPitchToSamples_j4do5z$(i);Nt("Comparing exact copies (incremental)...");var a=new z;t=r.size;for(var s=0;s<=t;s++){var l=r.subList_vux9f0$(0,s);console.log("Sublist:"+e.toString(l.size)),console.log(l),this.testShouldBe_3xie8k$.call(this,new O(l.size,l.size),a.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,this.notes,l))}},dt.prototype.exactIncrementalTestInBulk=function(){Nt("****** Beginning incremental bulk test");var t=new L;t.tempo=this.tempo;var n=gt().generateExactBufferCollectionFromNotes_jisecs$(this.notes,this.tempo),o=t.convertSamplesBufferToNotes_mtnj1d$(n),i=gt().addAvgPitchToSamples_j4do5z$(o);Nt("Comparing exact copies (incremental)...");var r=new O;r.correct=4,r.attempted=4;var a,s=new z,l=this.testShouldBe_3xie8k$,c=S(),p=this.notes,u=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(i,10));for(a=i.iterator();a.hasNext();){var h=a.next();u.add_11rb$(h.note)}l.call(this,r,c.compareNoteArrays_l4hzig$(p,u)),this.testShouldBe_3xie8k$(r,s.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,this.notes,i))},dt.prototype.sharpTest=function(){Nt("****** Beginning sharp test");var t=new z,n=new L;n.tempo=this.tempo;var o=gt().generateExactBufferCollectionFromNotes_jisecs$(this.notes,this.tempo),i=n.convertSamplesBufferToNotes_mtnj1d$(o),r=i.get_za3lpa$(1).note.getFrequency(),a=Y().getFrequencyForNoteNumber_za3lpa$(i.get_za3lpa$(1).note.noteNumber+1|0),s=a-r,l=s*((listenerApp.parameters.allowableCentsMargin+1|0)/100);Nt("Original freq: "+e.toString(r)),Nt("Next note up "+a+" distance "+s+" to move "+l),i.get_za3lpa$(3).note.avgFreq=r+l;var c=gt().addAvgPitchToSamples_j4do5z$(i);Nt("Comparing sharp copy...");var p=new O;p.correct=3,p.attempted=4,this.testShouldBe_3xie8k$(p,t.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,this.notes,c))},dt.prototype.flatTest=function(){Nt("****** Beginning flat test");var t=new z,n=new L;n.tempo=this.tempo;var o=gt().generateExactBufferCollectionFromNotes_jisecs$(this.notes,this.tempo),i=n.convertSamplesBufferToNotes_mtnj1d$(o),r=i.get_za3lpa$(1).note.getFrequency(),a=Y().getFrequencyForNoteNumber_za3lpa$(i.get_za3lpa$(1).note.noteNumber-1|0),s=r-a,l=s*((listenerApp.parameters.allowableCentsMargin+1|0)/100);Nt("Original freq: "+e.toString(r)),Nt("Next note up "+a+" distance "+s+" to move "+l),i.get_za3lpa$(3).note.avgFreq=r-l;var c=gt().addAvgPitchToSamples_j4do5z$(i);Nt("Comparing flat copy...");var p=new O;p.correct=3,p.attempted=4,this.testShouldBe_3xie8k$(p,t.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,this.notes,c))},dt.prototype.rushedTest=function(){Nt("****** Beginning rushed test");var t=new z,e=new L;e.tempo=this.tempo;var n=Bt([new G(69,.5),new G(81,1-listenerApp.parameters.allowableRhythmMargin-.01),new G(69,1),new G(81,1)]),o=gt().generateExactBufferCollectionFromNotes_jisecs$(n,this.tempo),i=e.convertSamplesBufferToNotes_mtnj1d$(o),r=gt().addAvgPitchToSamples_j4do5z$(i),a=new O;a.correct=2,a.attempted=4,Nt("Comparing rushed..."),this.testShouldBe_3xie8k$(a,t.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,this.notes,r))},dt.prototype.shortNotesTest=function(){Nt("****** Beginning short notes test");var t=new z,e=new L;e.tempo=this.tempo;var n=Bt([new G(69,.31),new G(35,.05),new G(69,.14),new G(81,.78),new G(34,.11),new G(35,.11),new G(69,1),new G(81,1)]),o=gt().generateExactBufferCollectionFromNotes_jisecs$(n,this.tempo),i=e.convertSamplesBufferToNotes_mtnj1d$(o),r=gt().addAvgPitchToSamples_j4do5z$(i),a=new O;a.correct=4,a.attempted=4,Nt("Comparing short notes..."),this.testShouldBe_3xie8k$(a,t.compareNoteArrays_puujnc$(listenerApp.parameters.comparisonFlags,this.notes,r))},dt.prototype.runTest=function(){return listenerApp=new n,listenerApp.parameters=new mt,Y().createAllNotes(),this.exactIncrementalTestInBulk(),this.rushedTest(),this.shortNotesTest(),this.pitchTrackerTest(),this.trueIncrementalComparisonTest(),this.sharpTest(),this.flatTest(),"Done"},dt.$metadata$={kind:e.Kind.OBJECT,simpleName:"SliceTest",interfaces:[]};var ne=null;ft.prototype.generateExactBufferFromNotes_jisecs$=function(t,e){return b().convertNotesToSamples_jisecs$(t,e)},ft.prototype.generateExactBufferCollectionWithSize1FromNotes_jisecs$=function(t,n){var o,i=60/n,r=e.kotlin.collections.ArrayList_init_ww73n8$(),a=e.kotlin.collections.ArrayList_init_ww73n8$();for(o=t.iterator();o.hasNext();){var s,l,c,p,u=o.next();a.add_11rb$(r.size);var h=u.duration*i*b().sampleRate,m=u.getFrequency();l=(s=vt(0,0|h)).first,c=s.last,p=s.step;for(var d=l;d<=c;d+=p)r.add_11rb$(m)}console.log("Note change indexes: "+e.toString(a));var f,g,y=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(r,10)),_=0;for(f=r.iterator();f.hasNext();){var v=f.next(),$=y.add_11rb$,w=new tt(v,1,(g=_,_=g+1|0,g));$.call(y,w)}return y},ft.prototype.generateExactBufferCollectionFromNotes_jisecs$=function(t,n){var o,i=60/n,r=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(t,10));for(o=t.iterator();o.hasNext();){var a=o.next(),s=r.add_11rb$,l=new tt(a.getFrequency(),a.duration*i*b().sampleRate|0,-1);s.call(r,l)}return r},ft.prototype.addAvgPitchToSamples_j4do5z$=function(t){var n,o=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(t,10));for(n=t.iterator();n.hasNext();){var i=n.next(),r=o.add_11rb$;null==i.note.avgFreq&&(i.note.avgFreq=i.note.getFrequency()),r.call(o,i)}return o},ft.prototype.addPitchVariationToSamples_d3e2cz$=function(t){var n,o=e.kotlin.collections.ArrayList_init_ww73n8$(e.kotlin.collections.collectionSizeOrDefault_ba2ldo$(t,10));for(n=t.iterator();n.hasNext();){var i=n.next(),r=o.add_11rb$,a=15*Math.random()*2;r.call(o,i+a/2)}return o},ft.prototype.addRhythmVariationToSamples_d3e2cz$=function(t){for(var e=xt(t),n=0;n<=3600;n++)e.removeAt_za3lpa$(0);for(var o=14e3;o<=18e3;o++)e.add_11rb$(e.get_za3lpa$(400));for(var i=13e3;i<=15500;i++)e.removeAt_za3lpa$(0);return e},ft.prototype.addShortItemsThatShouldBeRemoved_d3e2cz$=function(t){for(var e=xt(t),n=0;n<=5;n++)e.add_wxm5ur$(0,2);for(var o=0;o<=15;o++)e.add_wxm5ur$(100,2);for(var i=0;i<=3;i++)e.add_wxm5ur$(1e4,2);return e},ft.$metadata$={kind:e.Kind.OBJECT,simpleName:"TestBufferGenerator",interfaces:[]};var oe=null,ie=t.com||(t.com={}),re=ie.practicingmusician||(ie.practicingmusician={});re.ListenerApp=n,re.FlashMessage=i,re.ComparisonFlags=r,re.AppSetupParameters=a,re.AudioAnalyzer=s,re.GeneratedExercise=l,re.EasyScoreCode=c,re.SimpleJSNoteObject=p,re.BeatPosition=u,Object.defineProperty(re,"UserSettings",{get:m}),(re.audio||(re.audio={})).AudioManager=d;var ae=re.exercises||(re.exercises={});ae.ExerciseDefinition=y,ae.ExerciseManager=_;var se=re.finals||(re.finals={});Object.defineProperty(se,"BufferManager",{get:b}),Object.defineProperty(se,"CompareEngine",{get:S}),se.FeedbackMetric=x,Object.defineProperty(k,"Correct",{get:A}),Object.defineProperty(k,"Incorrect",{get:C}),Object.defineProperty(k,"Missed",{get:T}),se.FeedbackType=k,se.FeedbackItem=I,se.throwSafeIncorrectSwitch_a2klfm$=P,se.CompareResults=O,se.ResultsForDatabase=j,se.IndividualNotePerformanceInfo=E,se.NotePlacement=F,se.IncrementalBufferManager=L,se.IncrementalComparisonEngine=z,Object.defineProperty(B,"NoteChange",{get:M}),Object.defineProperty(B,"BeatChange",{get:R}),q.MarkerType=B,(re.models||(re.models={})).Slice=q;var le=re.network||(re.network={});Object.defineProperty(le,"ListenerNetworkManager",{get:U}),le.PerformanceWrapper=W;var ce=re.notes||(re.notes={});ce.EasyScoreUtil_Kotlin=J,ce.NotationItem=H,ce.Barline=V,Object.defineProperty(G,"Companion",{get:Y}),ce.Note=G,Object.defineProperty(ce,"ALL_NOTES",{get:function(){return Xt},set:function(t){Xt=t}});var pe=re.steppable||(re.steppable={});pe.Metronome=Q,Object.defineProperty(pe,"buflen",{get:function(){return Yt},set:function(t){Yt=t}}),pe.SampleCollection=tt,pe.PitchTracker=et,Object.defineProperty(ot,"Stopped",{get:rt}),Object.defineProperty(ot,"Running",{get:at}),Object.defineProperty(ot,"Completed",{get:st}),nt.TimeKeeperState=ot,pe.TimeKeeper=nt,pe.TimeKeeperSteppable=ct,pe.TimeKeeperAnalyzer=pt;var ue=re.tests||(re.tests={});return Object.defineProperty(ue,"PitchTrackerTest",{get:function(){return null===ee&&new ut,ee}}),ue.PitchTrackerTestClass=ht,ue.MockParameters=mt,Object.defineProperty(ue,"SliceTest",{get:function(){return null===ne&&new dt,ne}}),Object.defineProperty(ue,"TestBufferGenerator",{get:gt}),t.main_kand9s$=yt,Xt=e.kotlin.collections.ArrayList_init_ww73n8$(),Yt=1024,yt(),e.defineModule("PracticingMusician",t),t}(void 0===PracticingMusician?{}:PracticingMusician,kotlin);